<html dir="LTR">
<head>
    <title>'Direct Connect (DC) Plugin Wizard'</title>
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
    <link id="LINKURL" rel="stylesheet" href="../../1033/NewStyles.css">
    <!--  -->
    <!-- The SYMBOL tag is used to set the default values for the user-defined symbols.-->
    <!--  -->
    <symbol name='WIZARD_DIALOG_TITLE' type="text" value='Direct Connect (DC) .NET Plugin Wizard'></symbol>
    <symbol name='PLUGIN_DESCRIPTION' type="text" value=""></symbol>
    <symbol name='PLUGIN_AUTHOR' type="text" value=""></symbol>
    <symbol name='PLUGIN_WEBSITE' type="text" value=""></symbol>
    <symbol name='APP_TYPE_SUMMARY' type="text" value='//TODO: Application summary'></symbol>
</head>
<body bgcolor="BUTTONFACE" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"
    onload="InitDocument(document);" onkeydown="OnKey();" onkeypress="OnPress();">
    <table class="ONE" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
        <col width="100%">
        <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
        <tr valign="TOP">
            <td height="79" width="100%" colspan="2">
                <table class="TWO" border="0" cellpadding="0" cellspacing="0">
                    <col width="12">
                    <col>
                    <col width="12">
                    <tr>
                        <td valign="TOP" height="12" width="12">
                            &nbsp;
                        </td>
                        <td valign="TOP" height="12">
                            &nbsp;
                        </td>
                        <td valign="TOP" height="12" width="12">
                            &nbsp;
                        </td>
                        <td class="IMAGE" valign="BOTTOM" width="110" rowspan="2">
                            <div class="SMALLA" id="Layer0">
                                <img class="SMALLEST" src="../../Images/Plugins.ico" width="63" height="63"
                                    alt="" border="0">
                            </div>
                        </td>
                        <td valign="TOP" height="12" width="6" rowspan="2">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td valign="TOP" height="65" width="12">
                            &nbsp;
                        </td>
                        <td valign="TOP" height="65">
                            <h4 class="HEAD" id="HEAD">
                                Welcome to 'Direct Connect (DC) .NET Plugin Wizard'</h4>
                            <p class="SUBHEAD" id="SUBHEAD">
                                'Wizard for creation of Direct Connect (DC) .NET Plugins.'</p>
                        </td>
                        <td valign="TOP" height="65" width="12">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td valign="TOP" class="RULE" colspan="5" height="2">
                            <table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
                                <tr valign="TOP">
                                    <td height="1" width="100%" bgcolor="BUTTONSHADOW">
                                        <img src="../../Images/spacer.gif" height="1" width="1" alt=""></td>
                                    <td height="1" width="1" bgcolor="WINDOW">
                                        <img src="../../Images/spacer.gif" height="1" width="1" alt=""></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
        <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
        <tr valign="TOP">
            <td valign="TOP" height="100%">
                <!--OPEN OF CONTENT AND BUTTON TABLE//-->
                <table class="ONE" border="0" cellpadding="0" cellspacing="0">
                    <col width="100%">
                    <tr valign="TOP">
                        <td height="100%">
                            <!--OPEN OF CONTENT//-->
                            <table class="CONTENT" border="0" cellpadding="0" cellspacing="0">
                                <col width="12">
                                <col width="185">
                                <col width="12">
                                <col width="185">
                                <col width="12">
                                <col width="185">
                                <col width="12">
                                <tr>
                                    <td valign="TOP" height="12" colspan="5">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr valign="TOP">
                                    <td valign="TOP" width="12">
                                        &nbsp;
                                    </td>
                                    <td valign="TOP" colspan="3">
                                        <blockquote>
                                            <span class="itemTextTop">
                                                <div id="DIV5" class="itemText" title="Plugin name">
                                                    <label id="LABEL5" for="PROJECT_NAME" title="Plugin name">
                                                        Plugin name:</label>
                                                </div>
                                                <input id="PROJECT_NAME" accesskey="R" class="itemText" title="Plugin name" type="text">
                                            </span>
                                            <span class="itemTextTop">
                                                <div class="itemText" id="DIV4" title="Plugin description">
                                                    <label for="PLUGIN_DESCRIPTION" title="Plugin description" id="LABEL4">
                                                        Plugin description:</label>
                                                </div>
                                                <input class="itemText" type="text" id="PLUGIN_DESCRIPTION" size="100" accesskey="D"
                                                    title="Plugin description">
                                            </span>
                                            <span class="itemTextTop">
                                                <div class="itemText" id="DIV1" title="Plugin author">
                                                    <label for="PLUGIN_AUTHOR" title="Plugin author" id="LABEL1">
                                                        Plugin author:</label>
                                                </div>
                                                <input class="itemText" type="text" id="PLUGIN_AUTHOR" size="100" accesskey="A"
                                                    title="Plugin author">
                                            </span>
                                            <span class="itemTextTop">
                                                <div class="itemText" id="DIV2" title="Plugin website">
                                                    <label for="PLUGIN_WEBSITE" title="Plugin website" id="LABEL2">
                                                        Plugin website:</label>
                                                </div>
                                                <input class="itemText" type="text" id="PLUGIN_WEBSITE" size="100" accesskey="W"
                                                    title="Plugin website">
                                            </span>
                                            <p class="ElementSpacer">
                                                &nbsp;</p>
                                            <span class="itemTextTop">
                                                <div class="itemText" id="DIV6" title="Project folder">
                                                    <label for="PROJECT_PATH" title="Project folder" id="LABEL6">
                                                        <u>P</u>roject folder:</label>
                                                </div>
                                                <input class="itemText" type="text" id="PROJECT_PATH"  size="100" accesskey="D"
                                                    title="Project folder" />
                                                <input type="button" value="Browse..." onclick="PROJECT_PATH.value=getFolder()" />
                                            </span>
                                            <p class="ElementSpacer">
                                                &nbsp;</p>
                                            
                                        </blockquote>
                                    </td>
                                    <td valign="TOP" width="12">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td valign="TOP" height="100%" colspan="7">
                                        <div id="DebugInfo">
                                        </div>
                                        &nbsp;
                                    </td>
                                </tr>
                            </table>
                            <!--CLOSE OF CONTENT//-->
                        </td>
                    </tr>
                    <tr valign="BOTTOM">
                        <td height="48">
                            <!--OPEN OF BUTTON HTML//-->
                            <table height="48" border="0" cellpadding="0" cellspacing="0">
                                <col width="12">
                                <col>
                                <col width="75">
                                <col width="4">
                                <col width="75">
                                <col width="4">
                                <col width="75">
                                <col width="12">
                                <tr>
                                    <td valign="TOP" class="RULE" colspan="8" height="2">
                                        <table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
                                            <tr valign="TOP">
                                                <td height="1" width="100%" bgcolor="BUTTONSHADOW">
                                                    <img src="../../Images/spacer.gif" height="1" width="1" alt=""></td>
                                                <td height="1" width="1" bgcolor="WINDOW">
                                                    <img src="../../Images/spacer.gif" height="1" width="1" alt=""></td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td valign="TOP" height="11" colspan="8">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td valign="MIDDLE" height="23" width="12">
                                        &nbsp;
                                    </td>
                                    <td valign="TOP" height="23">
                                        &nbsp;
                                    </td>
                                    <td valign="MIDDLE" height="23" width="75">
                                        <button class="BUTTONS" id="FinishBtn" accesskey="F" onclick="OnFinish(document);">
                                            <u>F</u>inish</button>
                                    </td>
                                    <td valign="MIDDLE" height="23" width="4">
                                        &nbsp;
                                    </td>
                                    <td valign="MIDDLE" height="23" width="75">
                                        <button class="BUTTONS" id="CancelBtn" accesskey="C" onclick="window.external.Finish(document, 'cancel');">
                                            <u>C</u>ancel</button>
                                    </td>
                                    <td valign="MIDDLE" height="23" width="4">
                                        &nbsp;
                                    </td>
                                    <td valign="MIDDLE" height="23" width="75">
                                        <button class="BUTTONS" id="HelpBtn" accesskey="H" onclick="window.external.OnHelp('vc.appwiz.custom.overview');">
                                            <u>H</u>elp</button>
                                    </td>
                                    <td valign="MIDDLE" height="23" width="12">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td valign="TOP" height="12" colspan="8">
                                        &nbsp;
                                    </td>
                                </tr>
                            </table>
                            <!--CLOSE OF BUTTON HTML//-->
                        </td>
                    </tr>
                </table>
                <!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
            </td>
        </tr>
    </table>
</body>
</html>

<script language="JSCRIPT">


// This is an example of a function which initializes the page
//
function InitDocument(document)
{
	setDirection();
	
	if (window.external.FindSymbol('DOCUMENT_FIRST_LOAD'))
	{
		// This function sets the default symbols based 
		// on the values specified in the SYMBOL tags above
		//
		window.external.SetDefaults(document);
	}

    var strProjectName = window.external.FindSymbol( "PROJECT_NAME" );
    if ( strProjectName != null )
    {
        // The following if-statement is a fix for a problem in Visual Studio 10.0+
        // where the PROJECT_NAME variable contains the name twice
        if ( strProjectName.length > 0 )
        {
            var left = strProjectName.substr( 0, strProjectName.length / 2 );
            var right = strProjectName.substr( strProjectName.length / 2 );
            if ( left == right )
            {
                strProjectName = left;
                window.external.AddSymbol( "PROJECT_NAME", strProjectName );
            }
        }
        window.external.AddSymbol( "PROJECT_NAME", GetProjectName( strProjectName.toString() ) );
    }


	// Load the document and initialize the controls 
	// with the appropriate symbol values
	//
	window.external.Load(document);

	PROJECT_PATH.value = GetDefaultTargetFolder();
}

// If the wizard has more than 1 page, this 
// function will browse to the page specified
//
function Next(document, linkto)
{
	window.external.Next(document, linkto);
}

// This is an example of a function which
// gets called when the user clicks on 'Finish'
//
function OnFinish(document)
{
    if ((PROJECT_NAME.value == null) || (PROJECT_NAME.value == ''))
    {
        var strMessage = "Please specify the plugin name.";
        window.alert(strMessage);
        PROJECT_NAME.focus();
    }
    else if (TargetFolderExists())
    {
        var strMessage = "A plugin with the specified name '" + PROJECT_NAME.value + "' already exists.\nPlease select a different name.";
        window.alert(strMessage);
        PROJECT_NAME.focus();
    }
    else
    {
        OnWizFinish(document);
    }
}

function getFolder()
{
    var strOldPath = PROJECT_PATH.value;

    if (strOldPath == '')
    {
        strOldPath = GetDefaultTargetFolder();
    }

    try
    {
        return window.external.GetDirectoryViaBrowseDlg("Select target project folder:", strOldPath);
    }
    catch (e)
    {
    }
    return strOldPath;
}

function AppendBackslash(path)
{
    var lastChar = '';
    if (path.length > 0)
    {
        lastChar = path.substr(path.length - 1, 1);
    }
    if (lastChar != '\\')
    {
        path += '\\';
    }
    return path;
}

function TargetFolderExists()
{
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var strOutputPath = AppendBackslash(PROJECT_PATH.value);
    var strProjectName = PROJECT_NAME.value;
    var bRet = false;

    strOutputPath = AppendBackslash(strOutputPath);

    // First, check if target folder exists...
    bRet = fso.FolderExists(AppendBackslash(strOutputPath + strProjectName));

    fso = null;

    return bRet;
}

function GetDefaultTargetFolder()
{
    return 'C:\\Programming\\dc-plugin-sdk\\Plugins';
}

function GetProjectName( value )
{
    if( value != null )
    {
        var strValue = value.toString();
        var nPos = strValue.indexOf( '.' );
        
        if( nPos != -1 )
        {
            strValue = strValue.substr( nPos + 1 );
        }
        if( strValue.substr( strValue.length - 6 ).toLowerCase() == 'plugin' )
        {
            strValue = strValue.substr( 0, strValue.length - 6 );
        }
        return strValue;
    }
    return value;
}

</script>

<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>

<script id="INCLUDE_COMMON" language="JSCRIPT"></script>

<!-- 
Common.js is a script file which contains the helper functions 
used by the wizards.  Include this line if you want to
call these functions from your html scripts.
//-->

<script>
	var strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	strPath += "VCWizards/";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</script>

